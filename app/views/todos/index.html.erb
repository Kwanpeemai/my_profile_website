<div class="max-w-lg mx-auto p-8">
  <!-- Brag Document link -->
  <div class="mb-6 text-right">
    <%= link_to "📄 My Brag Document", brag_path, class: "text-blue-600 hover:underline font-medium" %>
  </div>

  <!-- Page title -->
  <h1 class="text-2xl font-bold mb-6 text-center text-gray-800">My Academy Quest</h1>

  <!-- Add Task Form -->
  <%= form_with(model: Todo.new, url: todos_path, local: true, class: "flex mb-8 gap-2") do |form| %>
    <%= form.text_field :title, placeholder: "Add a new task...",
        class: "flex-grow border-gray-300 rounded p-2 text-gray-700 focus:border-blue-400 focus:ring-1 focus:ring-blue-200 outline-none" %>
    <%= form.submit "+", class: "bg-blue-500 hover:bg-blue-600 text-white font-bold px-4 rounded transition" %>
  <% end %>

  <!-- Doing tasks -->
  <h2 class="text-lg text-gray-700 font-semibold mb-2">
    Tasks to do (<%= @todos.doing.count %>)
  </h2>
  <ul class="mb-8">
    <% @todos.doing.each do |todo| %>
      <li class="flex items-center justify-between py-2 px-1 border-b border-gray-100 last:border-b-0">
        <span class="text-gray-800"><%= todo.title %></span>
        <div class="flex items-center gap-2">
          <%= link_to "✔", todo_path(todo), method: :patch,
              class: "text-blue-500 hover:text-blue-700 text-lg font-bold px-2 rounded focus:ring-2 focus:ring-blue-200",
              title: "Mark as done",
              data: { "turbo-method": "patch" } %>
          <%= link_to "🗑", todo_path(todo), method: :delete,
              class: "text-red-400 hover:text-red-600 text-lg font-bold px-2 rounded focus:ring-2 focus:ring-red-200",
              data: { turbo_method: :delete, confirm: "Delete this task?" },
              title: "Delete" %>
        </div>
      </li>
    <% end %>
    <% if @todos.doing.count == 0 %>
      <li class="text-gray-400 italic text-center py-4">You have no tasks left!</li>
    <% end %>
  </ul>

  <!-- Done tasks -->
  <h2 class="text-lg text-gray-600 font-semibold mb-2">
    Done (<%= @todos.done.count %>)
  </h2>
  <ul>
    <% @todos.done.each do |todo| %>
      <li class="py-2 px-1 text-gray-400 line-through flex items-center justify-between">
        <span><%= todo.title %></span>
        <div class="flex items-center gap-2">
          <!-- ถ้าอยากให้ undo ได้ ให้ปลดคอมเมนต์บรรทัดด้านล่าง -->
          <%#= link_to "↩", todo_path(todo), method: :patch,
                  class: "text-green-400 hover:text-green-600 text-lg font-bold px-2 rounded",
                  title: "Mark as not done",
                  data: { "turbo-method": "patch" } %>
          <%= link_to "🗑", todo_path(todo), method: :delete,
              class: "text-red-400 hover:text-red-600 text-lg font-bold px-2 rounded focus:ring-2 focus:ring-red-200",
              data: { confirm: "Delete this task?" },
              title: "Delete" %>
        </div>
      </li>
    <% end %>
    <% if @todos.done.count == 0 %>
      <li class="text-gray-300 italic text-center py-4">No tasks completed yet</li>
    <% end %>
  </ul>
</div>